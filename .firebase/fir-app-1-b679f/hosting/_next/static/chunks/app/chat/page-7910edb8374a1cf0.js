(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[929],{7951:(e,t,a)=>{Promise.resolve().then(a.bind(a,4996))},6463:(e,t,a)=>{"use strict";var r=a(1169);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},4996:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>eo});var r=a(7437),s=a(2265),n=a(6463),l=a(9630),i=a(9842),o=a(9506);async function d(e,t,a,r,s,n){let l=await u(e,r);if(l)return l.id;let d={name:"",type:"private",participants:[e,r],participantNames:{[e]:t,[r]:s},participantPhotos:{[e]:a,[r]:n},lastMessage:"",lastMessageTime:(0,i.serverTimestamp)(),lastMessageSenderId:"",createdAt:(0,i.serverTimestamp)(),createdBy:e,unreadCount:{[e]:0,[r]:0}};return(await (0,i.ET)((0,i.hJ)(o.db,"chatRooms"),d)).id}async function c(e,t,a,r,s){let n=[...new Set([t,...a])],l={};n.forEach(e=>{l[e]=0});let d={name:e,type:"group",participants:n,participantNames:r,participantPhotos:s,lastMessage:"",lastMessageTime:(0,i.serverTimestamp)(),lastMessageSenderId:"",createdAt:(0,i.serverTimestamp)(),createdBy:t,unreadCount:l};return(await (0,i.ET)((0,i.hJ)(o.db,"chatRooms"),d)).id}async function u(e,t){let a=(0,i.IO)((0,i.hJ)(o.db,"chatRooms"),(0,i.ar)("type","==","private"),(0,i.ar)("participants","array-contains",e));for(let e of(await (0,i.PL)(a)).docs){let a={id:e.id,...e.data()};if(a.participants.includes(t))return a}return null}async function m(e){let t=(0,i.doc)(o.db,"chatRooms",e),a=await (0,i.QT)(t);return a.exists()?{id:a.id,...a.data()}:null}async function h(e,t,a,r,s){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"text",l=arguments.length>6?arguments[6]:void 0,d=arguments.length>7?arguments[7]:void 0,c={text:s,senderId:t,senderName:a,senderPhoto:r,chatRoomId:e,createdAt:(0,i.serverTimestamp)(),readBy:[t],type:n,...l&&{fileUrl:l},...d&&{fileName:d}},u=await (0,i.ET)((0,i.hJ)(o.db,"messages"),c),m=(0,i.doc)(o.db,"chatRooms",e),h=await (0,i.QT)(m);if(h.exists()){let e=h.data(),a={...e.unreadCount};e.participants.forEach(e=>{e!==t&&(a[e]=(a[e]||0)+1)}),await (0,i.updateDoc)(m,{lastMessage:"text"===n?s:"[".concat(n,"] ").concat(d||"file"),lastMessageTime:(0,i.serverTimestamp)(),lastMessageSenderId:t,unreadCount:a})}return u.id}async function f(e,t){let a=(0,i.IO)((0,i.hJ)(o.db,"messages"),(0,i.ar)("chatRoomId","==",e),(0,i.ar)("senderId","!=",t)),r=(await (0,i.PL)(a)).docs.map(async e=>{e.data().readBy.includes(t)||await (0,i.updateDoc)((0,i.doc)(o.db,"messages",e.id),{readBy:(0,i.vr)(t)})});await Promise.all(r);let s=(0,i.doc)(o.db,"chatRooms",e);await (0,i.updateDoc)(s,{["unreadCount.".concat(t)]:0})}async function p(e,t,r,s){let n=(0,i.doc)(o.db,"chatRooms",e,"typing",t);s?await (0,i.updateDoc)(n,{odUserId:t,userName:r,isTyping:!0,timestamp:(0,i.serverTimestamp)()}).catch(async()=>{let{setDoc:e}=await Promise.resolve().then(a.bind(a,9842));await e(n,{odUserId:t,userName:r,isTyping:!0,timestamp:(0,i.serverTimestamp)()})}):await (0,i.updateDoc)(n,{isTyping:!1}).catch(()=>{})}class x{startPresence(){this.setOnline(!0),this.heartbeatInterval=setInterval(()=>{this.setOnline(!0)},3e4),"undefined"!=typeof document&&document.addEventListener("visibilitychange",this.handleVisibilityChange),window.addEventListener("beforeunload",this.handleUnload)}stopPresence(){this.heartbeatInterval&&clearInterval(this.heartbeatInterval),this.setOnline(!1),"undefined"!=typeof document&&document.removeEventListener("visibilitychange",this.handleVisibilityChange),window.removeEventListener("beforeunload",this.handleUnload)}async setOnline(e){let{updateDoc:t,doc:r,serverTimestamp:s}=await Promise.resolve().then(a.bind(a,9842)),n=r(o.db,"users",this.userId);try{await t(n,{isOnline:e,lastSeen:s()})}catch(e){console.error("Failed to update presence:",e)}}constructor(e){this.heartbeatInterval=null,this.handleVisibilityChange=()=>{"visible"===document.visibilityState?this.setOnline(!0):this.setOnline(!1)},this.handleUnload=()=>{this.setOnline(!1)},this.userId=e}}function v(){let{user:e}=(0,l.a)(),[t,a]=(0,s.useState)([]),[r,n]=(0,s.useState)(!0),[u,m]=(0,s.useState)(null);return(0,s.useEffect)(()=>{if(!e){a([]),n(!1);return}n(!0),m(null);try{let t=function(e,t){let a=(0,i.IO)((0,i.hJ)(o.db,"chatRooms"),(0,i.ar)("participants","array-contains",e),(0,i.Xo)("lastMessageTime","desc"));return(0,i.cf)(a,e=>{let a=[];e.forEach(e=>{a.push({id:e.id,...e.data()})}),t(a)})}(e.uid,e=>{a(e),n(!1)});return()=>t()}catch(e){m(e),n(!1)}},[null==e?void 0:e.uid]),{rooms:t,loading:r,error:u,startPrivateChat:(0,s.useCallback)(async(t,a,r)=>{if(!e)throw Error("User not authenticated");return d(e.uid,e.displayName||"Anonymous",e.photoURL,t,a,r)},[e]),startGroupChat:(0,s.useCallback)(async(t,a,r,s)=>{if(!e)throw Error("User not authenticated");return c(t,e.uid,a,{...r,[e.uid]:e.displayName||"Anonymous"},{...s,[e.uid]:e.photoURL})},[e])}}var g=a(420),b=a(9055),y=a(2183),w=a(9354);function j(e){let{selectedRoomId:t,onSelectRoom:a}=e,{rooms:s,loading:n}=v(),{user:i}=(0,l.a)();return n?(0,r.jsx)("div",{className:"space-y-2 p-4",children:[1,2,3].map(e=>(0,r.jsxs)("div",{className:"flex items-center gap-3 p-3",children:[(0,r.jsx)(y.O,{className:"h-12 w-12 rounded-full"}),(0,r.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,r.jsx)(y.O,{className:"h-4 w-24"}),(0,r.jsx)(y.O,{className:"h-3 w-full"})]})]},e))}):0===s.length?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[(0,r.jsx)("div",{className:"rounded-full bg-slate-100 p-4 dark:bg-slate-800",children:(0,r.jsx)("svg",{className:"h-8 w-8 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),(0,r.jsx)("h3",{className:"mt-4 font-medium text-slate-900 dark:text-white",children:"No conversations yet"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-slate-500 dark:text-slate-400",children:"Start a new chat to begin messaging"})]}):(0,r.jsx)("div",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:s.map(e=>(0,r.jsx)(N,{room:e,currentUserId:(null==i?void 0:i.uid)||"",isSelected:t===e.id,onClick:()=>a(e.id)},e.id))})}function N(e){var t,a;let{room:s,currentUserId:n,isSelected:l,onClick:i}=e,o=s.unreadCount[n]||0,d=s.name,c=null;if("private"===s.type){let e=s.participants.find(e=>e!==n);e&&(d=s.participantNames[e]||"Unknown",c=s.participantPhotos[e])}let u=d.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2);return(0,r.jsxs)("button",{onClick:i,className:"flex w-full items-center gap-3 p-4 text-left transition-colors hover:bg-slate-50 dark:hover:bg-slate-800 ".concat(l?"bg-blue-50 dark:bg-blue-900/20":""),children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)(g.qE,{className:"h-12 w-12",children:[(0,r.jsx)(g.F$,{src:c||void 0,alt:d}),(0,r.jsx)(g.Q5,{className:"bg-gradient-to-br from-blue-500 to-purple-500 text-white",children:u})]}),"group"===s.type&&(0,r.jsx)("div",{className:"absolute -bottom-1 -right-1 flex h-5 w-5 items-center justify-center rounded-full bg-slate-200 text-xs dark:bg-slate-700",children:s.participants.length})]}),(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h4",{className:"truncate font-medium ".concat(o>0?"text-slate-900 dark:text-white":"text-slate-700 dark:text-slate-300"),children:d}),s.lastMessageTime&&(0,r.jsx)("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:(0,w.Q)((null===(a=s.lastMessageTime)||void 0===a?void 0:null===(t=a.toDate)||void 0===t?void 0:t.call(a))||new Date)})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("p",{className:"truncate text-sm ".concat(o>0?"font-medium text-slate-700 dark:text-slate-300":"text-slate-500 dark:text-slate-400"),children:s.lastMessage||"No messages yet"}),o>0&&(0,r.jsx)(b.C,{className:"ml-2 bg-blue-500 text-white",children:o>99?"99+":o})]})]})]})}function k(e){let{messages:t,currentUserId:a,typingUsers:n}=e,l=(0,s.useRef)(null);if((0,s.useEffect)(()=>{var e;null===(e=l.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[t,n]),0===t.length)return(0,r.jsxs)("div",{className:"flex flex-1 flex-col items-center justify-center p-8 text-center",children:[(0,r.jsx)("div",{className:"rounded-full bg-slate-100 p-4 dark:bg-slate-800",children:(0,r.jsx)("svg",{className:"h-8 w-8 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),(0,r.jsx)("h3",{className:"mt-4 font-medium text-slate-900 dark:text-white",children:"No messages yet"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-slate-500 dark:text-slate-400",children:"Send a message to start the conversation"})]});let i=function(e){let t={};return e.forEach(e=>{var a,r;let s=function(e){let t=new Date,a=new Date(t);return(a.setDate(a.getDate()-1),E(e,t))?"Today":E(e,a)?"Yesterday":new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:e.getFullYear()!==t.getFullYear()?"numeric":void 0}).format(e)}((null===(r=e.createdAt)||void 0===r?void 0:null===(a=r.toDate)||void 0===a?void 0:a.call(r))||new Date);t[s]||(t[s]=[]),t[s].push(e)}),t}(t);return(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-4",children:[Object.entries(i).map(e=>{let[t,s]=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"mb-4 flex items-center justify-center",children:(0,r.jsx)("span",{className:"rounded-full bg-slate-100 px-3 py-1 text-xs text-slate-500 dark:bg-slate-800 dark:text-slate-400",children:t})}),s.map((e,t)=>{var n;let l=e.senderId===a,i=!l&&(0===t||(null===(n=s[t-1])||void 0===n?void 0:n.senderId)!==e.senderId);return(0,r.jsx)(C,{message:e,isOwn:l,showAvatar:i},e.id)})]},t)}),n.length>0&&(0,r.jsx)(M,{users:n}),(0,r.jsx)("div",{ref:l})]})}function C(e){var t,a;let{message:s,isOwn:n,showAvatar:l}=e,i=s.senderName.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2),o=(null===(a=s.createdAt)||void 0===a?void 0:null===(t=a.toDate)||void 0===t?void 0:t.call(a))?new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"numeric",hour12:!0}).format(s.createdAt.toDate()):"";return(0,r.jsxs)("div",{className:(0,w.cn)("mb-2 flex items-end gap-2",n?"flex-row-reverse":"flex-row"),children:[!n&&(0,r.jsx)("div",{className:"w-8",children:l&&(0,r.jsxs)(g.qE,{className:"h-8 w-8",children:[(0,r.jsx)(g.F$,{src:s.senderPhoto||void 0,alt:s.senderName}),(0,r.jsx)(g.Q5,{className:"bg-gradient-to-br from-blue-500 to-purple-500 text-xs text-white",children:i})]})}),(0,r.jsxs)("div",{className:(0,w.cn)("group max-w-[70%]",n?"items-end":"items-start"),children:[!n&&l&&(0,r.jsx)("p",{className:"mb-1 ml-1 text-xs text-slate-500 dark:text-slate-400",children:s.senderName}),(0,r.jsxs)("div",{className:(0,w.cn)("rounded-2xl px-4 py-2",n?"bg-gradient-to-r from-blue-500 to-purple-500 text-white":"bg-slate-100 text-slate-900 dark:bg-slate-800 dark:text-white"),children:["text"===s.type&&(0,r.jsx)("p",{className:"break-words",children:s.text}),"image"===s.type&&(0,r.jsxs)("div",{children:[(0,r.jsx)("img",{src:s.fileUrl,alt:"Image",className:"max-h-64 rounded-lg"}),s.text&&(0,r.jsx)("p",{className:"mt-2 break-words",children:s.text})]}),"file"===s.type&&(0,r.jsxs)("a",{href:s.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-current underline",children:[(0,r.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),s.fileName||"Download file"]})]}),(0,r.jsx)("p",{className:(0,w.cn)("mt-1 text-xs text-slate-400 opacity-0 transition-opacity group-hover:opacity-100",n?"mr-1 text-right":"ml-1"),children:o})]})]})}function M(e){let{users:t}=e,a=t.map(e=>e.userName).join(", "),s=1===t.length?"".concat(a," is typing..."):"".concat(a," are typing...");return(0,r.jsxs)("div",{className:"mb-2 flex items-center gap-2",children:[(0,r.jsx)("div",{className:"flex h-8 w-8 items-center justify-center",children:(0,r.jsxs)("div",{className:"flex gap-1",children:[(0,r.jsx)("span",{className:"h-2 w-2 animate-bounce rounded-full bg-slate-400 [animation-delay:-0.3s]"}),(0,r.jsx)("span",{className:"h-2 w-2 animate-bounce rounded-full bg-slate-400 [animation-delay:-0.15s]"}),(0,r.jsx)("span",{className:"h-2 w-2 animate-bounce rounded-full bg-slate-400"})]})}),(0,r.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:s})]})}function E(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}var L=a(9733),R=a(4919),S=a(2874);function I(e){let{value:t,onChange:a,onSend:n,disabled:i}=e,{user:o}=(0,l.a)(),[d,c]=(0,s.useState)(!1),[u,m]=(0,s.useState)(!1),h=(0,s.useRef)(null),f=(0,s.useRef)(null),p=async()=>{if(t.trim()&&!d){c(!0);try{await n(t.trim())}finally{c(!1)}}},x=async(e,a)=>{var r;let s=null===(r=e.target.files)||void 0===r?void 0:r[0];if(s&&o){m(!0);try{let e="chat/".concat(o.uid,"/").concat(Date.now(),"_").concat(s.name),r=await (0,S.cT)(s,e);await n(t.trim()||"",a,r,s.name)}catch(e){console.error("Upload failed:",e)}finally{m(!1),h.current&&(h.current.value=""),f.current&&(f.current.value="")}}};return(0,r.jsx)("div",{className:"border-t border-slate-200 bg-white p-4 dark:border-slate-700 dark:bg-slate-900",children:(0,r.jsxs)("div",{className:"flex items-end gap-2",children:[(0,r.jsxs)("div",{className:"flex gap-1",children:[(0,r.jsx)("input",{ref:f,type:"file",accept:"image/*",className:"hidden",onChange:e=>x(e,"image")}),(0,r.jsx)(L.z,{type:"button",variant:"ghost",size:"icon",className:"h-10 w-10 rounded-full",onClick:()=>{var e;return null===(e=f.current)||void 0===e?void 0:e.click()},disabled:i||u,children:(0,r.jsx)("svg",{className:"h-5 w-5 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),(0,r.jsx)("input",{ref:h,type:"file",className:"hidden",onChange:e=>x(e,"file")}),(0,r.jsx)(L.z,{type:"button",variant:"ghost",size:"icon",className:"h-10 w-10 rounded-full",onClick:()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.click()},disabled:i||u,children:(0,r.jsx)("svg",{className:"h-5 w-5 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})})})]}),(0,r.jsx)("div",{className:"relative flex-1",children:(0,r.jsx)(R.g,{value:t,onChange:e=>a(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),p())},placeholder:"Type a message...",className:"min-h-[44px] max-h-32 resize-none rounded-2xl pr-12",disabled:i||u,rows:1})}),(0,r.jsx)(L.z,{type:"button",size:"icon",className:"h-10 w-10 rounded-full bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600",onClick:p,disabled:i||!t.trim()||d||u,children:d||u?(0,r.jsxs)("svg",{className:"h-5 w-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):(0,r.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})})}function T(e){let{room:t,currentUserId:a,onBack:s,onInfo:n}=e;if(!t)return(0,r.jsx)("div",{className:"flex h-16 items-center border-b border-slate-200 bg-white px-4 dark:border-slate-700 dark:bg-slate-900",children:(0,r.jsx)("h2",{className:"font-medium text-slate-500 dark:text-slate-400",children:"Select a conversation"})});let l=t.name,i=null,o="";if("private"===t.type){let e=t.participants.find(e=>e!==a);e&&(l=t.participantNames[e]||"Unknown",i=t.participantPhotos[e])}else o="".concat(t.participants.length," members");let d=l.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2);return(0,r.jsxs)("div",{className:"flex h-16 items-center justify-between border-b border-slate-200 bg-white px-4 dark:border-slate-700 dark:bg-slate-900",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[s&&(0,r.jsx)(L.z,{variant:"ghost",size:"icon",className:"md:hidden",onClick:s,children:(0,r.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,r.jsxs)(g.qE,{className:"h-10 w-10",children:[(0,r.jsx)(g.F$,{src:i||void 0,alt:l}),(0,r.jsx)(g.Q5,{className:"bg-gradient-to-br from-blue-500 to-purple-500 text-white",children:d})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"font-medium text-slate-900 dark:text-white",children:l}),o&&(0,r.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:o})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(L.z,{variant:"ghost",size:"icon",className:"rounded-full",children:(0,r.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),(0,r.jsx)(L.z,{variant:"ghost",size:"icon",className:"rounded-full",children:(0,r.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),n&&(0,r.jsx)(L.z,{variant:"ghost",size:"icon",className:"rounded-full",onClick:n,children:(0,r.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})]})}var P=a(9116),z=a(7209),D=a(1584),B=a(8149),O=a(1715),U=a(5238),_=a(1383);a(4887);var A=Symbol("radix.slottable");function F(e){return s.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===A}var W=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let a=function(e){let t=function(e){let t=s.forwardRef((e,t)=>{let{children:a,...r}=e;if(s.isValidElement(a)){let e,n;let l=(e=Object.getOwnPropertyDescriptor(a.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?a.ref:(e=Object.getOwnPropertyDescriptor(a,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?a.props.ref:a.props.ref||a.ref,i=function(e,t){let a={...t};for(let r in t){let s=e[r],n=t[r];/^on[A-Z]/.test(r)?s&&n?a[r]=(...e)=>{let t=n(...e);return s(...e),t}:s&&(a[r]=s):"style"===r?a[r]={...s,...n}:"className"===r&&(a[r]=[s,n].filter(Boolean).join(" "))}return{...e,...a}}(r,a.props);return a.type!==s.Fragment&&(i.ref=t?(0,D.F)(t,l):l),s.cloneElement(a,i)}return s.Children.count(a)>1?s.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),a=s.forwardRef((e,a)=>{let{children:n,...l}=e,i=s.Children.toArray(n),o=i.find(F);if(o){let e=o.props.children,n=i.map(t=>t!==o?t:s.Children.count(e)>1?s.Children.only(null):s.isValidElement(e)?e.props.children:null);return(0,r.jsx)(t,{...l,ref:a,children:s.isValidElement(e)?s.cloneElement(e,void 0,n):null})}return(0,r.jsx)(t,{...l,ref:a,children:n})});return a.displayName=`${e}.Slot`,a}(`Primitive.${t}`),n=s.forwardRef((e,s)=>{let{asChild:n,...l}=e,i=n?a:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,r.jsx)(i,{...l,ref:s})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{}),V="Checkbox",[$,J]=function(e,t=[]){let a=[],n=()=>{let t=a.map(e=>s.createContext(e));return function(a){let r=a?.[e]||t;return s.useMemo(()=>({[`__scope${e}`]:{...a,[e]:r}}),[a,r])}};return n.scopeName=e,[function(t,n){let l=s.createContext(n),i=a.length;a=[...a,n];let o=t=>{let{scope:a,children:n,...o}=t,d=a?.[e]?.[i]||l,c=s.useMemo(()=>o,Object.values(o));return(0,r.jsx)(d.Provider,{value:c,children:n})};return o.displayName=t+"Provider",[o,function(a,r){let o=r?.[e]?.[i]||l,d=s.useContext(o);if(d)return d;if(void 0!==n)return n;throw Error(`\`${a}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let a=()=>{let a=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let r=a.reduce((t,{useScope:a,scopeName:r})=>{let s=a(e)[`__scope${r}`];return{...t,...s}},{});return s.useMemo(()=>({[`__scope${t.scopeName}`]:r}),[r])}};return a.scopeName=t.scopeName,a}(n,...t)]}(V),[q,H]=$(V);function Y(e){let{__scopeCheckbox:t,checked:a,children:n,defaultChecked:l,disabled:i,form:o,name:d,onCheckedChange:c,required:u,value:m="on",internal_do_not_use_render:h}=e,[f,p]=(0,O.T)({prop:a,defaultProp:null!=l&&l,onChange:c,caller:V}),[x,v]=s.useState(null),[g,b]=s.useState(null),y=s.useRef(!1),w=!x||!!o||!!x.closest("form"),j={checked:f,disabled:i,setChecked:p,control:x,setControl:v,name:d,form:o,value:m,hasConsumerStoppedPropagationRef:y,required:u,defaultChecked:!ea(l)&&l,isFormControl:w,bubbleInput:g,setBubbleInput:b};return(0,r.jsx)(q,{scope:t,...j,children:"function"==typeof h?h(j):n})}var Q="CheckboxTrigger",K=s.forwardRef((e,t)=>{let{__scopeCheckbox:a,onKeyDown:n,onClick:l,...i}=e,{control:o,value:d,disabled:c,checked:u,required:m,setControl:h,setChecked:f,hasConsumerStoppedPropagationRef:p,isFormControl:x,bubbleInput:v}=H(Q,a),g=(0,D.e)(t,h),b=s.useRef(u);return s.useEffect(()=>{let e=null==o?void 0:o.form;if(e){let t=()=>f(b.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[o,f]),(0,r.jsx)(W.button,{type:"button",role:"checkbox","aria-checked":ea(u)?"mixed":u,"aria-required":m,"data-state":er(u),"data-disabled":c?"":void 0,disabled:c,value:d,...i,ref:g,onKeyDown:(0,B.Mj)(n,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,B.Mj)(l,e=>{f(e=>!!ea(e)||!e),v&&x&&(p.current=e.isPropagationStopped(),p.current||e.stopPropagation())})})});K.displayName=Q;var Z=s.forwardRef((e,t)=>{let{__scopeCheckbox:a,name:s,checked:n,defaultChecked:l,required:i,disabled:o,value:d,onCheckedChange:c,form:u,...m}=e;return(0,r.jsx)(Y,{__scopeCheckbox:a,checked:n,defaultChecked:l,disabled:o,required:i,onCheckedChange:c,name:s,form:u,value:d,internal_do_not_use_render:e=>{let{isFormControl:s}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(K,{...m,ref:t,__scopeCheckbox:a}),s&&(0,r.jsx)(et,{__scopeCheckbox:a})]})}})});Z.displayName=V;var G="CheckboxIndicator",X=s.forwardRef((e,t)=>{let{__scopeCheckbox:a,forceMount:s,...n}=e,l=H(G,a);return(0,r.jsx)(_.z,{present:s||ea(l.checked)||!0===l.checked,children:(0,r.jsx)(W.span,{"data-state":er(l.checked),"data-disabled":l.disabled?"":void 0,...n,ref:t,style:{pointerEvents:"none",...e.style}})})});X.displayName=G;var ee="CheckboxBubbleInput",et=s.forwardRef((e,t)=>{let{__scopeCheckbox:a,...n}=e,{control:l,hasConsumerStoppedPropagationRef:i,checked:o,defaultChecked:d,required:c,disabled:u,name:m,value:h,form:f,bubbleInput:p,setBubbleInput:x}=H(ee,a),v=(0,D.e)(t,x),g=function(e){let t=s.useRef({value:e,previous:e});return s.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}(o),b=(0,U.t)(l);s.useEffect(()=>{if(!p)return;let e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,t=!i.current;if(g!==o&&e){let a=new Event("click",{bubbles:t});p.indeterminate=ea(o),e.call(p,!ea(o)&&o),p.dispatchEvent(a)}},[p,g,o,i]);let y=s.useRef(!ea(o)&&o);return(0,r.jsx)(W.input,{type:"checkbox","aria-hidden":!0,defaultChecked:null!=d?d:y.current,required:c,disabled:u,name:m,value:h,form:f,...n,tabIndex:-1,ref:v,style:{...n.style,...b,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function ea(e){return"indeterminate"===e}function er(e){return ea(e)?"indeterminate":e?"checked":"unchecked"}et.displayName=ee;var es=a(2468);let en=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(Z,{ref:t,className:(0,w.cn)("grid place-content-center peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...s,children:(0,r.jsx)(X,{className:(0,w.cn)("grid place-content-center text-current"),children:(0,r.jsx)(es.Z,{className:"h-4 w-4"})})})});en.displayName=Z.displayName;var el=a(402);function ei(e){let{onChatCreated:t}=e,{user:a}=(0,l.a)(),{startPrivateChat:n,startGroupChat:d}=v(),[c,u]=(0,s.useState)(!1),[m,h]=(0,s.useState)(""),[f,p]=(0,s.useState)([]),[x,b]=(0,s.useState)([]),[y,w]=(0,s.useState)(!1),[j,N]=(0,s.useState)(""),[k,C]=(0,s.useState)(!1),[M,E]=(0,s.useState)(!1),[R,S]=(0,s.useState)([]);(0,s.useEffect)(()=>{if(!c){h(""),p([]),b([]),w(!1),N("");return}(async()=>{if(a){C(!0);try{let e=(0,i.hJ)(o.db,"users"),t=(0,i.IO)(e,(0,i.b9)(50)),r=await (0,i.PL)(t),s=[];r.forEach(e=>{let t=e.data();s.push({uid:e.id,displayName:e.id===a.uid?"".concat(t.displayName||"You"," (Saved Messages)"):t.displayName||"Anonymous",email:t.email||"",photoURL:t.photoURL})}),S(s),p(s)}catch(e){console.error("Load users failed:",e)}finally{C(!1)}}})()},[c,a]),(0,s.useEffect)(()=>{if(!m.trim()){p(R);return}p(R.filter(e=>{var t,a;return(null===(t=e.displayName)||void 0===t?void 0:t.toLowerCase().includes(m.toLowerCase()))||(null===(a=e.email)||void 0===a?void 0:a.toLowerCase().includes(m.toLowerCase()))}))},[m,R]);let I=e=>{y?x.some(t=>t.uid===e.uid)?b(x.filter(t=>t.uid!==e.uid)):b([...x,e]):b([e])},T=async()=>{if(0!==x.length){E(!0);try{let e;if(y&&x.length>1){let t={},a={};x.forEach(e=>{t[e.uid]=e.displayName,a[e.uid]=e.photoURL}),e=await d(j||"Group (".concat(x.length+1,")"),x.map(e=>e.uid),t,a)}else{let t=x[0];e=await n(t.uid,t.displayName,t.photoURL)}u(!1),t(e)}catch(e){console.error("Failed to create chat:",e)}finally{E(!1)}}};return(0,r.jsxs)(P.Vq,{open:c,onOpenChange:u,children:[(0,r.jsx)(P.hg,{asChild:!0,children:(0,r.jsxs)(L.z,{className:"w-full rounded-xl bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600",children:[(0,r.jsx)("svg",{className:"mr-2 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"New Chat"]})}),(0,r.jsxs)(P.cZ,{className:"sm:max-w-md",children:[(0,r.jsx)(P.fK,{children:(0,r.jsx)(P.$N,{children:"Start a New Chat"})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(en,{id:"group",checked:y,onCheckedChange:e=>w(e)}),(0,r.jsx)(el._,{htmlFor:"group",children:"Create group chat"})]}),y&&(0,r.jsx)(z.I,{placeholder:"Group name",value:j,onChange:e=>N(e.target.value)}),(0,r.jsx)(z.I,{placeholder:"Search users by name or email...",value:m,onChange:e=>h(e.target.value)}),x.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:x.map(e=>(0,r.jsxs)("div",{className:"flex items-center gap-1 rounded-full bg-blue-100 px-3 py-1 text-sm text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",children:[e.displayName,(0,r.jsx)("button",{onClick:()=>I(e),className:"ml-1 rounded-full hover:bg-blue-200 dark:hover:bg-blue-800",children:(0,r.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},e.uid))}),(0,r.jsx)("div",{className:"max-h-64 overflow-y-auto",children:k?(0,r.jsx)("div",{className:"flex justify-center py-4",children:(0,r.jsx)("div",{className:"h-6 w-6 animate-spin rounded-full border-2 border-blue-500 border-t-transparent"})}):0===f.length?(0,r.jsxs)("div",{className:"py-4 text-center",children:[(0,r.jsx)("p",{className:"text-sm text-slate-500",children:m?"No users match your search":"No other users registered yet"}),(0,r.jsx)("p",{className:"mt-1 text-xs text-slate-400",children:"Invite friends to join and start chatting!"})]}):(0,r.jsx)("div",{className:"space-y-1",children:f.map(e=>{let t=x.some(t=>t.uid===e.uid),a=e.displayName.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2);return(0,r.jsxs)("button",{onClick:()=>I(e),className:"flex w-full items-center gap-3 rounded-lg p-3 text-left transition-colors hover:bg-slate-100 dark:hover:bg-slate-800 ".concat(t?"bg-blue-50 dark:bg-blue-900/20":""),children:[(0,r.jsxs)(g.qE,{children:[(0,r.jsx)(g.F$,{src:e.photoURL||void 0}),(0,r.jsx)(g.Q5,{className:"bg-gradient-to-br from-blue-500 to-purple-500 text-white",children:a})]}),(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,r.jsx)("p",{className:"font-medium text-slate-900 dark:text-white",children:e.displayName}),(0,r.jsx)("p",{className:"truncate text-sm text-slate-500 dark:text-slate-400",children:e.email})]}),t&&(0,r.jsx)("svg",{className:"h-5 w-5 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},e.uid)})})}),(0,r.jsx)(L.z,{className:"w-full",onClick:T,disabled:0===x.length||M,children:M?"Creating...":"Start Chat"})]})]})]})}function eo(){let e=(0,n.useRouter)(),t=(0,n.useSearchParams)(),{user:a,loading:d}=(0,l.a)(),[c,u]=(0,s.useState)(null),[v,g]=(0,s.useState)(!0);!function(){let{user:e}=(0,l.a)(),t=(0,s.useRef)(null);(0,s.useEffect)(()=>{if(!e){t.current&&(t.current.stopPresence(),t.current=null);return}return t.current=new x(e.uid),t.current.startPresence(),()=>{t.current&&t.current.stopPresence()}},[null==e?void 0:e.uid])}(),(0,s.useEffect)(()=>{let e=t.get("room");e&&(u(e),g(!1))},[t]),(0,s.useEffect)(()=>{d||a||e.push("/auth")},[a,d,e]);let{room:b,messages:y,typingUsers:N,loading:C,inputValue:M,setInputValue:E,sendMessage:L}=function(e){let{user:t}=(0,l.a)(),[a,r]=(0,s.useState)(null),[n,d]=(0,s.useState)([]),[c,u]=(0,s.useState)([]),[x,v]=(0,s.useState)(!0),[g,b]=(0,s.useState)(null),[y,w]=(0,s.useState)(""),j=function(e,t){let[a,r]=(0,s.useState)(e);return(0,s.useEffect)(()=>{let t=setTimeout(()=>{r(e)},300);return()=>{clearTimeout(t)}},[e,300]),a}(y,0),N=(0,s.useRef)(null);(0,s.useEffect)(()=>{if(!e){r(null),v(!1);return}v(!0),m(e).then(r).catch(e=>b(e)).finally(()=>v(!1))},[e]),(0,s.useEffect)(()=>{if(!e){d([]);return}let t=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,r=(0,i.IO)((0,i.hJ)(o.db,"messages"),(0,i.ar)("chatRoomId","==",e),(0,i.Xo)("createdAt","asc"),(0,i.b9)(a));return(0,i.cf)(r,e=>{let a=[];e.forEach(e=>{a.push({id:e.id,...e.data()})}),t(a)})}(e,d);return()=>t()},[e]),(0,s.useEffect)(()=>{if(!e||!t){u([]);return}let a=function(e,t,a){let r=(0,i.hJ)(o.db,"chatRooms",e,"typing");return(0,i.cf)(r,e=>{let r=[];e.forEach(e=>{let a=e.data();if(a.isTyping&&a.odUserId!==t){var s;i.EK.now().seconds-((null===(s=a.timestamp)||void 0===s?void 0:s.seconds)||0)<5&&r.push(a)}}),a(r)})}(e,t.uid,u);return()=>a()},[e,null==t?void 0:t.uid]),(0,s.useEffect)(()=>{e&&t&&f(e,t.uid).catch(console.error)},[e,null==t?void 0:t.uid,n.length]),(0,s.useEffect)(()=>{if(e&&t&&y)return p(e,t.uid,t.displayName||"Anonymous",!0),N.current&&clearTimeout(N.current),N.current=setTimeout(()=>{p(e,t.uid,t.displayName||"Anonymous",!1)},2e3),()=>{N.current&&clearTimeout(N.current)}},[j,e,null==t?void 0:t.uid,null==t?void 0:t.displayName]);let k=(0,s.useCallback)(async function(a){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text",s=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(!e||!t)throw Error("Cannot send message");await h(e,t.uid,t.displayName||"Anonymous",t.photoURL,a,r,s,n),w(""),p(e,t.uid,t.displayName||"Anonymous",!1)},[e,t]),C=(0,s.useCallback)(()=>{if(!a||!t||"private"!==a.type)return null;let e=a.participants.find(e=>e!==t.uid);return e?{id:e,name:a.participantNames[e],photo:a.participantPhotos[e]}:null},[a,t]);return{room:a,messages:n,typingUsers:c,loading:x,error:g,inputValue:y,setInputValue:w,sendMessage:k,getChatPartner:C}}(c),R=t=>{u(t),g(!1),e.push("/chat?room=".concat(t),{scroll:!1})};return d?(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-slate-50 dark:bg-slate-900",children:(0,r.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-blue-500 border-t-transparent"})}):a?(0,r.jsxs)("div",{className:"flex h-screen bg-slate-50 dark:bg-slate-900",children:[(0,r.jsxs)("div",{className:(0,w.cn)("flex h-full w-full flex-col border-r border-slate-200 bg-white dark:border-slate-700 dark:bg-slate-900 md:w-80 lg:w-96",v?"block":"hidden md:block"),children:[(0,r.jsxs)("div",{className:"flex h-16 items-center justify-between border-b border-slate-200 px-4 dark:border-slate-700",children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Messages"}),(0,r.jsx)("button",{onClick:()=>e.push("/"),className:"rounded-full p-2 hover:bg-slate-100 dark:hover:bg-slate-800",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})})]}),(0,r.jsx)("div",{className:"p-4",children:(0,r.jsx)(ei,{onChatCreated:e=>{R(e)}})}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,r.jsx)(j,{selectedRoomId:c,onSelectRoom:R})})]}),(0,r.jsx)("div",{className:(0,w.cn)("flex flex-1 flex-col",v?"hidden md:flex":"block"),children:c?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(T,{room:b,currentUserId:a.uid,onBack:()=>{g(!0),u(null),e.push("/chat",{scroll:!1})}}),(0,r.jsx)(k,{messages:y,currentUserId:a.uid,typingUsers:N}),(0,r.jsx)(I,{value:M,onChange:E,onSend:L,disabled:C})]}):(0,r.jsxs)("div",{className:"flex flex-1 flex-col items-center justify-center p-8 text-center",children:[(0,r.jsx)("div",{className:"rounded-full bg-gradient-to-br from-blue-500 to-purple-500 p-6",children:(0,r.jsx)("svg",{className:"h-12 w-12 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),(0,r.jsx)("h2",{className:"mt-6 text-2xl font-bold text-slate-900 dark:text-white",children:"Your Messages"}),(0,r.jsx)("p",{className:"mt-2 max-w-sm text-slate-500 dark:text-slate-400",children:"Select a conversation from the sidebar or start a new chat to begin messaging."})]})})]}):null}},420:(e,t,a)=>{"use strict";a.d(t,{F$:()=>o,Q5:()=>d,qE:()=>i});var r=a(7437),s=a(2265),n=a(7609),l=a(9354);let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.fC,{ref:t,className:(0,l.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...s})});i.displayName=n.fC.displayName;let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.Ee,{ref:t,className:(0,l.cn)("aspect-square h-full w-full",a),...s})});o.displayName=n.Ee.displayName;let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.NY,{ref:t,className:(0,l.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...s})});d.displayName=n.NY.displayName},9055:(e,t,a)=>{"use strict";a.d(t,{C:()=>i});var r=a(7437);a(2265);var s=a(3027),n=a(9354);let l=(0,s.j)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:a,...s}=e;return(0,r.jsx)("div",{className:(0,n.cn)(l({variant:a}),t),...s})}},9733:(e,t,a)=>{"use strict";a.d(t,{z:()=>d});var r=a(7437),s=a(2265),n=a(1538),l=a(3027),i=a(9354);let o=(0,l.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:a,variant:s,size:l,asChild:d=!1,...c}=e,u=d?n.g7:"button";return(0,r.jsx)(u,{className:(0,i.cn)(o({variant:s,size:l,className:a})),ref:t,...c})});d.displayName="Button"},9116:(e,t,a)=>{"use strict";a.d(t,{$N:()=>p,Be:()=>x,Vq:()=>o,cN:()=>f,cZ:()=>m,fK:()=>h,hg:()=>d});var r=a(7437),s=a(2265),n=a(2834),l=a(4697),i=a(9354);let o=n.fC,d=n.xz,c=n.h_;n.x8;let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.aV,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s})});u.displayName=n.aV.displayName;let m=s.forwardRef((e,t)=>{let{className:a,children:s,...o}=e;return(0,r.jsxs)(c,{children:[(0,r.jsx)(u,{}),(0,r.jsxs)(n.VY,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...o,children:[s,(0,r.jsxs)(n.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(l.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=n.VY.displayName;let h=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};h.displayName="DialogHeader";let f=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};f.displayName="DialogFooter";let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.Dx,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",a),...s})});p.displayName=n.Dx.displayName;let x=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.dk,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...s})});x.displayName=n.dk.displayName},7209:(e,t,a)=>{"use strict";a.d(t,{I:()=>l});var r=a(7437),s=a(2265),n=a(9354);let l=s.forwardRef((e,t)=>{let{className:a,type:s,...l}=e;return(0,r.jsx)("input",{type:s,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...l})});l.displayName="Input"},402:(e,t,a)=>{"use strict";a.d(t,{_:()=>d});var r=a(7437),s=a(2265),n=a(8364),l=a(3027),i=a(9354);let o=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.f,{ref:t,className:(0,i.cn)(o(),a),...s})});d.displayName=n.f.displayName},2183:(e,t,a)=>{"use strict";a.d(t,{O:()=>n});var r=a(7437),s=a(9354);function n(e){let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,s.cn)("animate-pulse rounded-md bg-primary/10",t),...a})}},4919:(e,t,a)=>{"use strict";a.d(t,{g:()=>l});var r=a(7437),s=a(2265),n=a(9354);let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("textarea",{className:(0,n.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...s})});l.displayName="Textarea"},9630:(e,t,a)=>{"use strict";a.d(t,{AuthProvider:()=>i,a:()=>o});var r=a(7437),s=a(2265),n=a(4282);let l=(0,s.createContext)({user:null,loading:!0,logout:async()=>{}});function i(e){let{children:t}=e,[a,i]=(0,s.useState)(null),[o,d]=(0,s.useState)(!0);(0,s.useEffect)(()=>{let e=(0,n.w7)(e=>{i(e),d(!1)});return()=>e()},[]);let c=async()=>{await (0,n.kS)(),i(null)};return(0,r.jsx)(l.Provider,{value:{user:a,loading:o,logout:c},children:t})}function o(){let e=(0,s.useContext)(l);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},4282:(e,t,a)=>{"use strict";a.d(t,{DY:()=>m,Ew:()=>f,OA:()=>p,Ry:()=>d,Yb:()=>o,c0:()=>c,kS:()=>v,qD:()=>x,qj:()=>u,w7:()=>g});var r=a(5735),s=a(9842),n=a(9506);let l=new r.hJ,i=new r._O;async function o(e,t,a){let s=await (0,r.Xb)(n.I8,e,t);return await (0,r.ck)(s.user,{displayName:a}),await b(s.user,"email"),s.user}async function d(e,t){return(await (0,r.e5)(n.I8,e,t)).user}async function c(e){await (0,r.LS)(n.I8,e)}async function u(){let e=await (0,r.rh)(n.I8,l);return await b(e.user,"google"),e.user}async function m(){let e=await (0,r.rh)(n.I8,i);return await b(e.user,"facebook"),e.user}let h=null;function f(e){return new r.lI(n.I8,e,{size:"invisible",callback:()=>{console.log("reCAPTCHA solved")}})}async function p(e,t){return h=await (0,r.$g)(n.I8,e,t)}async function x(e){if(!h)throw Error("Please request OTP first");let t=await h.confirm(e);return await b(t.user,"phone"),t.user}async function v(){await (0,r.w7)(n.I8)}function g(e){return(0,r.Aj)(n.I8,e)}async function b(e,t){let a=(0,s.doc)(n.db,"users",e.uid);if(!(await (0,s.QT)(a)).exists()){let r={uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,phoneNumber:e.phoneNumber,provider:t,createdAt:(0,s.serverTimestamp)()};await (0,s.setDoc)(a,r)}return a}},9506:(e,t,a)=>{"use strict";a.d(t,{I8:()=>o,ZP:()=>u,db:()=>d,tO:()=>c});var r=a(5236),s=a(5735),n=a(9842),l=a(9854);let i=0===(0,r.C6)().length?(0,r.ZF)({apiKey:"AIzaSyCjcqQDzHy7cnEQKRfrHnGPTjlTdJWRL30",authDomain:"fir-app-1-b679f.firebaseapp.com",projectId:"fir-app-1-b679f",storageBucket:"fir-app-1-b679f.firebasestorage.app",messagingSenderId:"772249596028",appId:"1:772249596028:web:37d2651a6b124813b9d9f9"}):(0,r.C6)()[0],o=(0,s.v0)(i),d=(0,n.ad)(i),c=(0,l.cF)(i),u=i},2874:(e,t,a)=>{"use strict";a.d(t,{C7:()=>o,FW:()=>d,JB:()=>c,_I:()=>i,bW:()=>l,cT:()=>n,ng:()=>m,sS:()=>u});var r=a(9854),s=a(9506);async function n(e,t){let a=(0,r.iH)(s.tO,t),n=await (0,r.KV)(a,e,{contentType:e.type});return await (0,r.Jt)(n.ref)}function l(e,t,a){let n=(0,r.iH)(s.tO,t),l=(0,r.B0)(n,e,{contentType:e.type});return l.on("state_changed",e=>{var t;let r=e.bytesTransferred/e.totalBytes*100;null===(t=a.onProgress)||void 0===t||t.call(a,{progress:r,bytesTransferred:e.bytesTransferred,totalBytes:e.totalBytes,state:e.state})},e=>{var t;null===(t=a.onError)||void 0===t||t.call(a,e)},async()=>{var e;let t=await (0,r.Jt)(l.snapshot.ref);null===(e=a.onComplete)||void 0===e||e.call(a,t)}),l}async function i(e){let t=(0,r.iH)(s.tO,e);await (0,r.oq)(t)}async function o(e){let t=(0,r.iH)(s.tO,e);return Promise.all((await (0,r.aF)(t)).items.map(async e=>{let[t,a]=await Promise.all([(0,r.Jt)(e),(0,r.sd)(e)]);return{name:e.name,path:e.fullPath,url:t,size:a.size,type:a.contentType||"unknown",createdAt:new Date(a.timeCreated)}}))}function d(e,t,a){let r=Date.now(),s=a.replace(/[^a-zA-Z0-9.-]/g,"_");return"".concat(t,"/").concat(e,"/").concat(r,"_").concat(s)}function c(e){return e.type.startsWith("image/")?"image":e.type.startsWith("video/")?"video":e.type.includes("pdf")||e.type.includes("document")||e.type.includes("sheet")||e.type.includes("presentation")||e.type.includes("text")?"document":"other"}function u(e){if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]}function m(e,t){return e.size<=1048576*t}},9354:(e,t,a)=>{"use strict";a.d(t,{Q:()=>l,cn:()=>n});var r=a(4839),s=a(6164);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.m6)((0,r.W)(t))}function l(e){let t=Math.floor((new Date().getTime()-e.getTime())/1e3);if(t<60)return"just now";let a=Math.floor(t/60);if(a<60)return"".concat(a,"m ago");let r=Math.floor(a/60);if(r<24)return"".concat(r,"h ago");let s=Math.floor(r/24);if(s<7)return"".concat(s,"d ago");let n=Math.floor(s/7);return n<4?"".concat(n,"w ago"):new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric"}).format(e)}},8364:(e,t,a)=>{"use strict";a.d(t,{f:()=>i});var r=a(2265),s=a(5171),n=a(7437),l=r.forwardRef((e,t)=>(0,n.jsx)(s.WV.label,{...e,ref:t,onMouseDown:t=>{var a;t.target.closest("button, input, select, textarea")||(null===(a=e.onMouseDown)||void 0===a||a.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));l.displayName="Label";var i=l}},e=>{var t=t=>e(e.s=t);e.O(0,[358,990,639,247,712,765,130,215,744],()=>t(7951)),_N_E=e.O()}]);